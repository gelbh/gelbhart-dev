<% content_for :title, page_title("Hevy Tracker") %>
<% meta_description "Connect your Hevy workout data to Google Sheets™ with our secure OAuth integration. Easy setup guide for syncing fitness tracking between platforms." %>
<% content_for :structured_data do %>
  <%= render_structured_data(software_application_structured_data(
    name: "Hevy Tracker",
    description: "Google Workspace add-on that connects your Hevy workout data to Google Sheets™ with secure OAuth integration. Sync your fitness tracking data automatically.",
    url: "https://gelbhart.dev/projects/hevy-tracker",
    application_category: "WebApplication",
    operating_system: "Web",
    offers: {
      "price" => "0",
      "priceCurrency" => "USD"
    }
  )) %>
  <%= render_structured_data(faq_structured_data([
    {
      question: "What is Hevy Tracker?",
      answer: "Hevy Tracker is a Google Workspace add-on that securely connects your Hevy workout data to Google Sheets™ using OAuth 2.0 authentication. It automatically syncs your fitness tracking data so you can analyze it in spreadsheets."
    },
    {
      question: "How do I set up Hevy Tracker?",
      answer: "Setup takes about 2 minutes: 1) Copy the spreadsheet template to your Google Drive, 2) Install the add-on from the Google Workspace Marketplace, 3) Get your API key from Hevy Settings, and 4) Grant OAuth consent to connect and sync."
    },
    {
      question: "Do I need a Hevy Pro subscription?",
      answer: "Yes, Hevy Tracker requires a Hevy Pro subscription and an API key from Hevy's Developer Settings to access your workout data."
    },
    {
      question: "Is my data secure?",
      answer: "Yes, Hevy Tracker uses industry-standard OAuth 2.0 authentication. Your data is only used to sync between Hevy and your personal Google Sheets™. We don't store or share your information with any third parties."
    }
  ])) %>
  <%# Article structured data for project page %>
  <% hevy_article_data = article_structured_data(
    title: "Hevy Tracker",
    url: "https://gelbhart.dev/projects/hevy-tracker",
    description: "Google Workspace add-on that connects your Hevy workout data to Google Sheets™ with secure OAuth integration. Sync your fitness tracking data automatically.",
    keywords: "Hevy Tracker, Google Sheets, fitness tracking, workout data, Google Workspace add-on, OAuth, Hevy integration, fitness analytics",
    image: "logos/social/logo_social.png"
  ) %>
  <%= render_structured_data(hevy_article_data) %>
<% end %>
<!-- Hero Section with Gradient Background -->
<section class="position-relative hevy-tracker-hero" data-controller="scroll-animation">
  <!-- Animated Gradient Background -->
  <div class="hevy-tracker-gradient-bg"></div>
  <div class="container py-4 position-relative zindex-5">
    <div class="row justify-content-center text-center">
      <div class="col-lg-8 fade-in-view">
        <%= image_tag "hevy-tracker/hevy-tracker-logo.svg", width: 80, height: 80, class: "mb-3", alt: "Hevy Tracker", loading: "lazy" %>
        <h1 class="display-5 mb-2">Hevy Tracker</h1>
        <p class="lead text-light mb-2">Connect Hevy to Google Sheets™</p>
        <p class="text-light opacity-75 mb-0">
          Sync your workout data from Hevy to Google Sheets™ with secure OAuth integration. Track your fitness progress with the power of spreadsheets.
        </p>
      </div>
    </div>
  </div>
</section>
<!-- Breadcrumb Navigation -->
<div class="container pt-4">
  <%= render 'shared/breadcrumb', items: [
    { name: 'Home', url: '/' },
    { name: 'Projects', url: nil },
    { name: 'Hevy Tracker', url: nil }
  ] %>
</div>
<!-- Main Content -->
<section class="container py-5 mt-4" data-controller="scroll-animation">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-xl-9">
      <!-- Getting Started - Featured Card -->
      <div class="card hevy-tracker-card border-0 shadow-lg mb-4 fade-in-view delay-1">
        <div class="card-body p-4 p-lg-5">
          <div class="d-flex align-items-center mb-4">
            <div class="me-3">
              <%= render 'shared/icon_circle', icon: 'bx-rocket', color: 'primary', size: 'md' %>
            </div>
            <h2 class="h3 mb-0">Getting Started</h2>
          </div>
          <!-- Horizontal Steps Component -->
          <div class="steps steps-sm steps-horizontal-md steps-center mb-4">
            <div class="step">
              <div class="step-number">
                <div class="step-number-inner">1</div>
              </div>
              <div class="step-body">
                <h5 class="mb-2">Copy Template</h5>
                <p class="mb-0 text-muted small">
                  <%= link_to "Copy spreadsheet", hevy_tracker_spreadsheet_path, class: "text-primary fw-semibold" %> to Drive
                </p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">
                <div class="step-number-inner">2</div>
              </div>
              <div class="step-body">
                <h5 class="mb-2">Install Add-on</h5>
                <p class="mb-0 text-muted small">
                  From Extensions menu
                </p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">
                <div class="step-number-inner">3</div>
              </div>
              <div class="step-body">
                <h5 class="mb-2">Get API Key</h5>
                <p class="mb-0 text-muted small">
                  From <%= link_to "Hevy Settings", "https://hevy.com/settings?developer", target: "_blank", rel: "noopener", class: "text-primary fw-semibold" %>
                </p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">
                <div class="step-number-inner">4</div>
              </div>
              <div class="step-body">
                <h5 class="mb-2">Connect & Sync</h5>
                <p class="mb-0 text-muted small">
                  Grant OAuth consent
                </p>
              </div>
            </div>
          </div>
          <div class="text-center pt-3">
            <div class="d-flex flex-column flex-sm-row gap-3 justify-content-center">
              <a href="https://workspace.google.com/marketplace/app/hevy_tracker/221696974247" target="_blank" rel="noopener" class="btn btn-primary btn-lg">
                <i class="bx bx-download me-2"></i>Install Add-on
              </a>
              <a href="https://github.com/gelbh/hevy-tracker" target="_blank" rel="noopener noreferrer" class="btn btn-outline-secondary btn-lg">
                <i class="bx bxl-github me-2"></i><span class="d-none d-sm-inline">View on GitHub</span><span class="d-inline d-sm-none">GitHub</span>
              </a>
            </div>
            <p class="text-muted small mt-3 mb-0">
              <i class="bx bx-time-five me-1"></i>Setup takes ~2 minutes
            </p>
          </div>
        </div>
      </div>
      <!-- Stats Section -->
      <div class="card hevy-tracker-card border-0 shadow-lg mb-4 fade-in-view delay-3" data-controller="analytics-stats">
        <div class="card-body p-4 p-lg-5">
          <div class="text-center mb-4">
            <h2 class="h3 mb-2">Trusted by Fitness Enthusiasts Worldwide</h2>
            <p class="text-muted">Join hundreds of users tracking their progress with Hevy Tracker</p>
          </div>
          <!-- Key Metrics -->
          <div class="row g-4 text-center mb-4">
            <div class="col-6 col-lg-3">
              <div class="p-3">
                <div class="display-4 fw-bold text-primary mb-2"
                                     data-controller="counter"
                                     data-counter-duration-value="2000"
                                     data-analytics-stats-target="activeUsers">
                  0
                </div>
                <div class="text-muted small">Active Users</div>
                <div class="text-muted" style="font-size: 0.75rem;">Since Nov 2024</div>
              </div>
            </div>
            <div class="col-6 col-lg-3">
              <div class="p-3">
                <div class="display-4 fw-bold text-success mb-2"
                                     data-controller="counter"
                                     data-counter-duration-value="2000"
                                     data-analytics-stats-target="installCount">
                  0
                </div>
                <div class="text-muted small">Workspace Downloads</div>
                <div class="text-muted" style="font-size: 0.75rem;">Google Marketplace</div>
              </div>
            </div>
            <div class="col-6 col-lg-3">
              <div class="p-3">
                <div class="display-4 fw-bold text-info mb-2"
                                     data-controller="counter"
                                     data-counter-duration-value="2000"
                                     data-analytics-stats-target="countries">
                  0
                </div>
                <div class="text-muted small">Countries</div>
                <div class="text-muted" style="font-size: 0.75rem;">Global reach</div>
              </div>
            </div>
            <div class="col-6 col-lg-3">
              <div class="p-3">
                <div class="display-4 fw-bold text-warning mb-2"
                                     data-controller="counter"
                                     data-counter-suffix-value="%"
                                     data-counter-duration-value="2000"
                                     data-analytics-stats-target="engagementRate">
                  0%
                </div>
                <div class="text-muted small">Engagement Rate</div>
                <div class="text-muted" style="font-size: 0.75rem;">Highly engaged</div>
              </div>
            </div>
          </div>
          <!-- Top Countries -->
          <div class="border-top pt-4">
            <h5 class="text-center mb-4">Top Countries Using Hevy Tracker</h5>
            <div class="row g-3" data-analytics-stats-target="countriesList">
              <!-- Countries will be dynamically rendered here -->
            </div>
            <div class="text-center mt-4">
              <button class="btn btn-sm btn-outline-primary"
                                    data-analytics-stats-target="expandButton"
                                    data-action="click->analytics-stats#toggleCountries">
                <i class="bx bx-chevron-down me-1"></i>Show All Countries
              </button>
            </div>
          </div>
        </div>
      </div>
      <!-- Spreadsheet Preview -->
      <div class="card hevy-tracker-card border-0 shadow-lg mb-4 fade-in-view delay-4">
        <div class="card-body p-4 p-lg-5">
          <div class="text-center mb-4">
            <div class="d-flex align-items-center justify-content-center mb-3">
              <div class="me-3">
                <%= render 'shared/icon_circle', icon: 'bx-spreadsheet', color: 'primary', size: 'md' %>
              </div>
              <h3 class="h4 mb-0">Spreadsheet Interface</h3>
            </div>
            <p class="text-muted mb-4">
              A comprehensive view of your Hevy workout data in Google Sheets™, featuring automatic data organization and ready-to-use analytics.
            </p>
          </div>
          <!-- Image Gallery with Tabs -->
          <div class="mb-4">
            <!-- Tab Navigation -->
            <ul class="nav nav-tabs mb-3" id="spreadsheetTabs" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="main-tab" data-bs-toggle="tab" data-bs-target="#main-view" type="button" role="tab" aria-controls="main-view" aria-selected="true">
                  <i class="bx bx-table me-2"></i>Main View
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="tier-tab" data-bs-toggle="tab" data-bs-target="#tier-view" type="button" role="tab" aria-controls="tier-view" aria-selected="false">
                  <i class="bx bx-trophy me-2"></i>Tier List
                </button>
              </li>
            </ul>
            <!-- Tab Content -->
            <div class="tab-content" id="spreadsheetTabContent">
              <!-- Main Spreadsheet View -->
              <div class="tab-pane fade show active" id="main-view" role="tabpanel" aria-labelledby="main-tab">
                <div class="gallery-item rounded-3 overflow-hidden position-relative" 
                                     data-bs-toggle="modal" 
                                     data-bs-target="#imageModal" 
                                     data-image="<%= asset_path('hevy-tracker/main.webp') %>" 
                                     data-alt="Hevy Tracker main spreadsheet interface">
                  <%= image_tag "hevy-tracker/main.webp", 
                                        alt: "Hevy Tracker main spreadsheet interface showing workout data organized in Google Sheets",
                                        class: "img-fluid rounded-3",
                                        loading: "lazy" %>
                </div>
                <div class="text-center mt-3 pb-3">
                  <h5 class="mb-2">Main Spreadsheet View</h5>
                  <p class="text-muted mb-0 small">Your complete workout history organized and ready for analysis</p>
                </div>
              </div>
              <!-- Tier List View -->
              <div class="tab-pane fade" id="tier-view" role="tabpanel" aria-labelledby="tier-tab">
                <div class="gallery-item rounded-3 overflow-hidden position-relative" 
                                     data-bs-toggle="modal" 
                                     data-bs-target="#imageModal" 
                                     data-image="<%= asset_path('hevy-tracker/tier-list.webp') %>" 
                                     data-alt="Hevy Tracker tier list">
                  <%= image_tag "hevy-tracker/tier-list.webp", 
                                        alt: "Hevy Tracker tier list showing exercise performance rankings",
                                        class: "img-fluid rounded-3",
                                        loading: "lazy" %>
                </div>
                <div class="text-center mt-3 pb-3">
                  <h5 class="mb-2">Exercise Tier List</h5>
                  <p class="text-muted mb-0 small">Visualize your exercise performance and progress rankings</p>
                </div>
              </div>
            </div>
          </div>
          <!-- Feature highlights -->
          <div class="row g-3 pt-3 border-top">
            <div class="col-md-4 text-center">
              <i class="bx bx-table text-primary fs-4 mb-2 d-block"></i>
              <div class="fw-semibold small">Organized Data</div>
              <div class="text-muted small">Clean table structure</div>
            </div>
            <div class="col-md-4 text-center">
              <i class="bx bx-bar-chart text-success fs-4 mb-2 d-block"></i>
              <div class="fw-semibold small">Ready Analytics</div>
              <div class="text-muted small">Built-in visualizations</div>
            </div>
            <div class="col-md-4 text-center">
              <i class="bx bx-sync text-info fs-4 mb-2 d-block"></i>
              <div class="fw-semibold small">Auto Updates</div>
              <div class="text-muted small">Always in sync</div>
            </div>
          </div>
        </div>
      </div>
      <!-- Features Grid -->
      <div class="row g-4 mb-4 fade-in-view delay-2">
        <div class="col-md-6">
          <%= render 'shared/feature_card',
                        icon: 'bx-lock-alt',
                        color: 'success',
                        title: 'Secure OAuth',
                        description: 'Industry-standard OAuth 2.0 authentication ensures your data remains private and secure.',
                        card_classes: 'hevy-tracker-card' %>
        </div>
        <div class="col-md-6">
          <%= render 'shared/feature_card',
                        icon: 'bx-sync',
                        color: 'info',
                        title: 'Auto Sync',
                        description: 'Automatically sync your workout data from Hevy to your personal spreadsheet.',
                        card_classes: 'hevy-tracker-card' %>
        </div>
        <div class="col-md-6">
          <%= render 'shared/feature_card',
                        icon: 'bx-spreadsheet',
                        color: 'warning',
                        title: 'Google Sheets™',
                        description: 'Leverage the power of spreadsheets to analyze and visualize your fitness data.',
                        card_classes: 'hevy-tracker-card' %>
        </div>
        <div class="col-md-6">
          <%= render 'shared/feature_card',
                        icon: 'bx-dumbbell',
                        color: 'danger',
                        title: 'Hevy Pro',
                        description: 'Works seamlessly with your Hevy Pro subscription and API access.',
                        card_classes: 'hevy-tracker-card' %>
        </div>
      </div>
      <!-- Required Access -->
      <div class="card hevy-tracker-card border-0 shadow mb-4 fade-in-view delay-5">
        <div class="card-body p-4">
          <div class="d-flex align-items-center mb-4">
            <div class="me-3">
              <%= render 'shared/icon_circle', icon: 'bx-shield-alt-2', color: 'primary', size: 'md' %>
            </div>
            <h3 class="h4 mb-0">Required Permissions</h3>
          </div>
          <div class="row g-3">
            <div class="col-md-6">
              <div class="d-flex align-items-start">
                <div class="me-3 flex-shrink-0">
                  <%= render 'shared/icon_circle', icon: 'bx-spreadsheet', color: 'primary', size: 'sm' %>
                </div>
                <div>
                  <strong class="d-block mb-1">View and manage spreadsheets</strong>
                  <p class="text-muted small mb-0">To update your workout tracking spreadsheet with Hevy data</p>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-start">
                <div class="me-3 flex-shrink-0">
                  <%= render 'shared/icon_circle', icon: 'bx-cloud', color: 'primary', size: 'sm' %>
                </div>
                <div>
                  <strong class="d-block mb-1">External API access</strong>
                  <p class="text-muted small mb-0">To sync workout data from Hevy's servers</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Requirements -->
      <div class="card hevy-tracker-card border-0 shadow mb-4 fade-in-view delay-6">
        <div class="card-body p-4">
          <div class="d-flex align-items-center mb-3">
            <div class="me-3">
              <%= render 'shared/icon_circle', icon: 'bx-list-check', color: 'primary', size: 'md' %>
            </div>
            <h3 class="h4 mb-0">Requirements</h3>
          </div>
          <ul class="list-unstyled mb-0">
            <li class="d-flex align-items-center mb-2">
              <i class="bx bx-check-circle text-success me-3 fs-5"></i>
              <span>Hevy Pro subscription</span>
            </li>
            <li class="d-flex align-items-center">
              <i class="bx bx-check-circle text-success me-3 fs-5"></i>
              <span>Hevy API key (from <%= link_to "Developer Settings", "https://hevy.com/settings?developer", target: "_blank", rel: "noopener", class: "text-primary" %>)</span>
            </li>
          </ul>
        </div>
      </div>
      <!-- Privacy Notice -->
      <div class="card hevy-tracker-card border-0 shadow mb-4 fade-in-view delay-7">
        <div class="card-body p-4">
          <div class="d-flex align-items-start">
            <div class="bg-success bg-opacity-10 rounded-circle p-3 me-3 flex-shrink-0">
              <i class="bx bx-lock-alt fs-4 text-success"></i>
            </div>
            <div>
              <h3 class="h5 mb-2">Privacy & Security</h3>
              <p class="text-muted mb-0">Your data is only used to sync between Hevy and your personal Google Sheets™. We don't store or share your information with any third parties. All data transfer uses secure OAuth 2.0 authentication.</p>
            </div>
          </div>
        </div>
      </div>
      <!-- Footer Links -->
      <div class="text-center mt-4 fade-in-view delay-8">
        <p class="text-muted">
          By using this add-on, you agree to our <%= link_to "Terms of Service", hevy_tracker_terms_path, class: "text-primary" %> and <%= link_to "Privacy Policy", hevy_tracker_privacy_path, class: "text-primary" %>
        </p>
      </div>
    </div>
  </div>
</section>
<!-- Image Zoom Modal -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content bg-dark border-0">
      <div class="modal-header border-0">
        <h5 class="modal-title text-white" id="imageModalLabel">Screenshot</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-0">
        <img id="modalImage" src="" alt="" class="img-fluid w-100">
      </div>
    </div>
  </div>
</div>
<script>
  // Handle image modal zoom
  document.addEventListener('turbo:load', function() {
      const imageModal = document.getElementById('imageModal');

      if (imageModal) {
          imageModal.addEventListener('show.bs.modal', function (event) {
              const trigger = event.relatedTarget;
              if (trigger) {
                  const imageSrc = trigger.dataset.image || trigger.closest('[data-image]')?.dataset.image;
                  const imageAlt = trigger.dataset.alt || trigger.closest('[data-alt]')?.dataset.alt;
                  const modalImage = document.getElementById('modalImage');
                  const modalTitle = imageModal.querySelector('.modal-title');

                  if (modalImage && imageSrc) {
                      modalImage.src = imageSrc;
                      modalImage.alt = imageAlt || '';
                      if (modalTitle) {
                          modalTitle.textContent = imageAlt || 'Screenshot';
                      }
                  }
              }
          });
      }
  });
</script>
